extends ../base

block content 
    if String(video.owner._id) === String(localUser._id)
        a(href=`/video/${video._id}/delete`) 삭제하기
    div#videoContainer.relative.width-1080
        video(src="/" + video.fileURL data-id=video._id).w-full
        div#videoController.w-full.px-5.absolute.bottom-10.opacity-0.transition-opacity
            div.flex.mb-5
                input(type="range" min=0 step=1 value=0)#timeRange.flex-1
                div.mx-5.text-white.text-xl
                    span#currentTime 00:00:00
                    span  / 
                    span#totalTime  00:00:00
            div.flex.items-center.text-white.px-5.justify-between
                div
                    i.fas.fa-play.fa-2x.mr-10#playBtn
                    i.fas.fa-volume-up.fa-2x.mr-5#muteBtn
                    input(type="range" min=0 max=1 step=0.1 value=0.5)#volumeRange
                div
                    i.fas.fa-expand.fa-2x#fullBtn               
    div.flex.flex-col.mt-5
        span.text-2xl.font-medium=video.title
        span.text-lg.text-gray-500.mt-2 조회수 #{video.meta.views}회 · #{video.createdAt.getFullYear()}. #{video.createdAt.getMonth()+1}. #{video.createdAt.getDate()}.
    div.flex.border-t.border-b.py-5.my-5.width-1080
        a(href=`/user/${video.owner._id}`)
            div(style=`background-image:url(${video.owner.avatarURL.includes("http") ? video.owner.avatarURL : "/" + video.owner.avatarURL});background-size:cover;background-position:center; width:70px;height:70px`).rounded-full
        div.ml-6.w-full
            a(href=`/user/${video.owner._id}`)
                span.text-lg.font-semibold=video.owner.userName
            div.text-gray-500.mt-2=video.description
    div.text-xl.mb-5
        span 댓글 
        span#commentTotal=video.comments.length
        span 개
    if isLoggedIn
        form#commentForm.width-1080.flex.flex-col
            input#commentInput(type="text" placeholder="공개 댓글 추가..." class="w-full bg-transparent pb-1 border-b focus:outline-none focus:border-black" maxLength=100)
            div.flex.justify-between
                div(class="pointer-events-none")
                button#commentBtn.px-7.py-3.mt-2.rounded-md.font-medium.bg-gray-200.text-gray-600.pointer-events-none 댓글
    section#commentList.mt-5.width-1080.px-1(data-url=localUser.avatarURL data-name=localUser.userName)
        each comment in video.comments.reverse()
            div.flex.mb-5(data-id=comment._id)
                div(style=`background-image:url(${comment.owner.avatarURL.includes("http") ? comment.owner.avatarURL : "/" + comment.owner.avatarURL});background-size:cover;background-position:center; width:50px;height:50px`).rounded-full
                div.flex.justify-between.w-full.items-center
                    div.ml-5.flex.flex-col 
                        span.font-semibold=comment.owner.userName
                        span=comment.text
                    div 
                        if String(comment.owner._id) === String(localUser._id)
                            i.fas.fa-trash.icon-hover
block script    
    script(src="/static/js/videoPlayer.js" defer)
    script(src="/static/js/comment.js" defer)